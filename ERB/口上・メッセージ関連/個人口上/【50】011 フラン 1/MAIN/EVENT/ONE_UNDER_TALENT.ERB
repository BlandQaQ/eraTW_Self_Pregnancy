;一人之下素质
@k1011OneUnderGetMessage
	CALL k1011GP("W", @"芙兰酱的眼神有些奇怪…")
	CALL k1011GP("W", @"明明总以折磨他人为乐的芙兰酱，在看见%CALLNAME:MASTER%时，眼神却变得水润了。")
	CALL k1011GPC("W", @"「%k1011Name(TARGET, MASTER)%、%k1011Name(TARGET, TARGET)%最近又没有好好听话、欺负了其他人哦、是不是要给坏孩子一些惩罚呀♪」", TARGET)
	;喜欢芙兰
	IF k1011Love()
		CALL k1011GP("W", @"看到芙兰宛如婴儿般吹弹可破、白皙中透着些桃粉色的光泽的娇嫩肌肤、%CALLNAME:MASTER%有些为难地低头")
		CALL k1011GP("W", @"这怎么下得去手嘛…")
		CALL k1011GP("L", @"但不给%CALLNAME:MASTER%多久思考时间、芙兰酱就突然把身体紧贴了过来")
		CALL k1011GP("L", @"呼吸却逐渐变得急促起来、脸上带着酡红、眼里满是期望…")
		CALL k1011GPC("W", @"「怎么了、%k1011Name(TARGET, MASTER)%?快点惩罚芙兰吧」", TARGET)
		IF k1011GetTalent("施虐狂", MASTER)
			CALL k1011GP("W", @"在芙兰故意示弱与哀求下、%CALLNAME:MASTER%心头燃起一簇火苗")
			CALL k1011GPC("L", @"「呀♥、%k1011Name(TARGET, MASTER)%」", TARGET)
			CALL k1011GP("W", @"最终、抵挡不住欲望的%CALLNAME:MASTER%、粗暴地提起芙兰的翅膀、少女幼小的躯体无力地悬在了空中")
			CALL k1011GP("W", @"把眼前的胖次一把扯下、对着雪白稚嫩的小桃臀就是一巴掌")
			CALL k1011GPC("W", @"「%k1011Sound("Pain", "呀、啊啊啊——")%%k1011Name(TARGET, MASTER)%♥」", TARGET)
			CALL k1011GSleep()
			CALL k1011GP("W", @"不知过了多久、芙兰酱的屁股红的像桃子、真快像「水蜜桃」般汁水四溢时、二人的SM欲望才得到满足")
		ELSE
			CALL k1011GP("W", @"%CALLNAME:MASTER%就如同被妹妹祈求了的兄长般、看着昂贵的洋娃娃不知所措。")
			CALL k1011GP("W", @"但再犹豫下来也不是办法啊。%CALLNAME:MASTER%便狠下心、扯开芙兰酱的内裤、对着光滑的小蜜臀来了一巴掌")
			CALL k1011GPC("W", @"「%k1011Sound("Pain", "哇啊♥……")%不够、再来一次、再来一次」", TARGET)
			CALL k1011GP("W", @"芙兰整只蝠软了下来，趴在%CALLNAME:MASTER%怀里满脸享受的模样、无奈之下只能继续忽轻忽重地拍着、芙兰的呻吟也随之变得婉转多变")
			CALL k1011GSleep()
			CALL k1011GP("W", @"不知道过了多久、芙兰酱才终于满足地睡了过去")
			CALL k1011GP("W", @"%CALLNAME:MASTER%有些心疼地摸那快渗出血的『桃臀』、艰难地斜身取出药箱，给趴在腿上的芙兰上药")
		ENDIF
		CALL k1011GPC("L", @"「真奇怪啊、这种事应该%k1011Name(TARGET, TARGET)%来做的……」", TARGET)
		CALL k1011GPC("W", @"「被%k1011Name(TARGET, MASTER)%欺负……为什么这么期待呢」", TARGET)
		CALL k1011GPC("W", @"「%k1011Name(TARGET, MASTER)%、欺负%k1011Name(TARGET, TARGET)%吧、好喜欢♪」", TARGET)
	;不喜欢芙兰
	ELSE
		IF k1011GetTalent("施虐狂", MASTER)
			CALL k1011GP("W", @"正在寻找发泄对象的%CALLNAME:MASTER%、粗暴一把提起芙兰的翅膀、幼小的躯体被强行拉到空中、翅根处渗出了血")
			CALL k1011GPC("W", @"「啊、%k1011Name(TARGET, MASTER)%♥」", TARGET)
			CALL k1011GP("W", @"撕下碍事的胖次、对着眼前那雪白稚嫩的小粉臀就是一巴掌")
			CALL k1011GPC("W", @"「%k1011Sound("Pain", "啊、啊啊啊♥——")%%k1011Name(TARGET, MASTER)%」", TARGET)
			CALL k1011GSleep()
			CALL k1011GP("L", @"不知道过了多久、芙兰酱的屁股被拍得红彤彤的、仿佛熟过头的蜜桃般渗出了『汁水』、%CALLNAME:MASTER%的欲望才得到了缓解")
			CALL k1011GP("W", @"弄坏了可不行、随手松开翅膀、抄起跌落的芙兰放在一边、该回去办公了")
			CALL k1011GPC("L", @"「讨厌、%k1011Name(TARGET, TARGET)%明明不想被欺负……」", TARGET)
			CALL k1011GPC("W", @"「可是被%k1011Name(TARGET, MASTER)%打屁股……好开心啊」", TARGET)
			CALL k1011GP("W", @"没有在意芙兰的自言自语、%CALLNAME:MASTER%自顾自离开了")
			CALL k1011GPC("W", @"「唔、下次%k1011Name(TARGET, MASTER)%还会欺负%k1011Name(TARGET, TARGET)%吧♪」", TARGET)
		ELSE
			CALL k1011GP("L", @"看来芙兰酱已经彻底变成M了、比起之前那个熊孩子、喜欢受虐的吸血鬼更能卖出好价钱啊、%CALLNAME:MASTER%这么想着")
			CALL k1011GP("W", @"心情愉悦地抱起了芙兰")
			CALL k1011GPC("L", @"「好温暖啊、%k1011Name(TARGET, TARGET)%想被欺负了……」", TARGET)
			CALL k1011GPC("W", @"「每次被%k1011Name(TARGET, MASTER)%靠近……就有种特别渴望被欺负的感觉」", TARGET)
			CALL k1011GPC("W", @"「真奇怪啊…明明、就算是偷偷放芙兰出来的美铃姐姐、芙兰也只会想着虐杀她」", TARGET)
			CALL k1011GPC("W", @"「呼呼、快、欺负%k1011Name(TARGET, TARGET)%吧♪」", TARGET)
			CALL k1011GP("W", @"%CALLNAME:MASTER%心头一震，再三追问芙兰是否愿意被别人欺负")
			CALL k1011GPC("L", @"「%k1011Name(TARGET, TARGET)%只对虐待别人感兴趣！欺负%k1011Name(TARGET, TARGET)%的家伙通通去死！…啊、看到了吗、%k1011Name(TARGET, MASTER)%、%k1011Name(TARGET, TARGET)%是坏孩子、快惩罚芙兰♥……」", TARGET)
			CALL k1011GP("W", @"开什么玩笑、只想被一个人欺负？若不是奴隶的话还怪让人感动的、可作为奴隶的话不会有买家喜欢的！要是被发现了更是会被买家狠狠杀价！啧")
			CALL k1011GP("W", @"心情跌入谷底的%CALLNAME:MASTER%不等芙兰继续说话就手一松、任由芙兰摔到地上、头也不回的离开了")
			CALL k1011GPC("W", @"「唔、%k1011Name(TARGET, MASTER)%好粗暴、%k1011Name(TARGET, TARGET)%、好喜欢♥…」", TARGET)
		ENDIF
	ENDIF
	SIF k1011GetTalent("施虐狂")
		CALL k1011GP("L", @"芙兰[施虐狂]失去了")
	SIF k1011GetTalent("受虐狂")
		CALL k1011GP("L", @"芙兰[受虐狂]失去了")
	CALL k1011GP("W", @"芙兰[一人之下]获得了")

;判断是否取得[一人之下],每回合开始时判断
@k1011GetOneUnderJudge
	;已经取得
	SIF k1011GetCTalent(2)
		RETURN
	;必须恋慕
	SIF !k1011GetTalent("恋慕")
		RETURN
	;前置条件不满足
	SIF !(k1011GetAbl("施虐感") >= 5 && k1011GetAbl("受虐感") >= 5)
		RETURN
	;需要连续执行200次M指令
	SIF K1011OneUnderAccNum < 50
		RETURN
	;取得文本
	DRAWLINE
	CALL k1011OneUnderGetMessage()
	;DP
	CALL k1011SetTalent()
	CALL k1011SetTalent("施虐狂", 0)
	CALL k1011SetTalent("受虐狂", 0)
	CALL k1011SetCTalent(2, 1)

;先行口上处理
@k1011UnderOneF
	;没有[一人之下]
	SIF !k1011GetCTalent(2)
		RETURN
	;非猪脚时为施虐狂
	IF PLAYER != MASTER
		CALL k1011SetTalent("施虐狂", 1)
		CALL k1011SetTalent("受虐狂", 0)
	;主人相反
	ELSE
		CALL k1011SetTalent("施虐狂", 0)
		CALL k1011SetTalent("受虐狂", 1)
	ENDIF

;调教结束处理
@k1011UnderOneE
	;没有[一人之下]
	SIF !k1011GetCTalent(2)
		RETURN
	CALL k1011SetTalent("施虐狂", 0)
	CALL k1011SetTalent("受虐狂", 0)

;回合结束处理
@k1011UnderOneTurnend
	;已经有素质了
	SIF k1011GetCTalent(2)
		RETURN
	;自然下降
	SIF K1011OneUnderAccNum
		K1011OneUnderAccNum -= 1

;培养素质
@k1011UnderOneTrain
	;已经有素质了
	SIF k1011GetCTalent(2)
		RETURN
	;S芙兰类
	SIF GROUPMATCH(k1011GetNowSelectcom(), 220, 221, 222, 223, 224, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 240, 241, 251, 253, 270)
		K1011OneUnderAccNum += 1
	;被芙兰S类
	SIF GROUPMATCH(k1011GetNowSelectcom(), 47, 271, 272, 273)
		K1011OneUnderAccNum -= 10
	;保底
	K1011OneUnderAccNum = MAX(K1011OneUnderAccNum, 0)
